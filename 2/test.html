<!doctype html5>
<head>
    <style>
        html, body {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0
        }
        canvas {
            width: 600px;
            height: 600px;
        }
    </style>
</head>
<body>
<script>

let width, height
const canvas = document.createElement('canvas')
const ctx = canvas.getContext('2d')
document.body.appendChild(canvas)
const { abs, floor, max, PI, sin } = Math

/*
window.onresize = function () {
    width = window.innerWidth
    height = window.innerHeight
    canvas.width = width * 2
    canvas.height = height * 2
    ctx.scale(2, 2)
}
window.onresize()
*/
width = height = 600
canvas.width = width * 2
canvas.height = height * 2
ctx.scale(2, 2)
</script>
<script src="render.js"></script>
<script>
const POINT_SPACING = 5

function isWhite (p /* pixelData */) {
    return ((p[0] + p[1] + p[2]) != (255 * 3))
}

function render () {
    ctx.save()
    ctx.fillStyle = 'white'
    ctx.fillRect(0, 0, width, height)
    ctx.fillStyle = 'black'
    ctx.font = "120px Helvetica"
    ctx.translate(20, 20)
    ctx.translate(0, 120)
    ctx.fillText("Aim", 0, 0)
    ctx.translate(0, 120)
    ctx.fillText("for", 0, 0)
    ctx.translate(0, 120)
    ctx.fillText("the", 0, 0)
    ctx.translate(0, 120)
    ctx.fillText("impossible", 0, 0)
    ctx.restore()

    for (let i = 0; i <= width / POINT_SPACING; ++i) {
        for (let j = 0; j <= height / POINT_SPACING; ++j) {
            const x = j * POINT_SPACING
            const y = i * POINT_SPACING
            const pixelData = ctx.getImageData(x, y, 1, 1).data
            if (isWhite(pixelData)) {
                ctx.fillStyle = 'red'
                ctx.fillRect(x, y, 1, 1)
            }
        }
    }
}
</script>
<script>
function loop () {
    requestAnimationFrame(loop)
    render()
}
render()

// screenshot generator
document.addEventListener('keypress', function (e) {
    console.log(e)
    if (e.code === "Space") {
        // generate "shot"
        const img = new Image()
        img.width = img.height = 600
        img.src = canvas.toDataURL()
        document.body.appendChild(img)
    }
})
</script>
</body>